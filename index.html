<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sites Embebidos com Stack Tools</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        .iframe-container {
            margin-top: 20px;
            position: relative;
            display: inline-block;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            resize: both;
            width: 400px;
            height: 300px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        .controls {
            margin-top: 10px;
        }
        .anchor-buttons {
            position: fixed;
            right: 20px;
            top: 20px;
            background-color: #ffffff;
            padding: 15px;
            border: 1px solid #007BFF;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .anchor-buttons button {
            display: block;
            margin-bottom: 10px;
            padding: 10px;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007BFF;
            transition: background-color 0.3s, transform 0.2s;
        }
        .anchor-buttons button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        .input-field {
            margin-bottom: 15px;
        }
    </style>
    <script>
        let sites = [
            { id: 'iframe1', url: 'https://sobralfreenat.github.io/FNW_MAE/', initials: 'Decoder', width: 374, height: 900 },
            { id: 'iframe2', url: 'https://sobralfreenat.github.io/mae_prompt_generator/', initials: 'Encoder', width: 500, height: 500 }
        ];

        function adjustSize(iframeId) {
            const iframe = document.getElementById(iframeId);
            const width = document.getElementById(iframeId + '-width').value;
            const height = document.getElementById(iframeId + '-height').value;
            iframe.style.width = width + 'px';
            iframe.style.height = height + 'px';
        }

        function adjustAllSizes(value) {
            document.getElementById('general-width-value').textContent = value;
            sites.forEach(site => {
                document.getElementById(site.id + '-width').value = value;
                adjustSize(site.id);
            });
        }

        function highlightIframe(iframeId) {
            sites.forEach(site => {
                const iframe = document.getElementById(site.id);
                iframe.classList.remove('iframe-selected');
            });
            const selectedIframe = document.getElementById(iframeId);
            selectedIframe.classList.add('iframe-selected');
        }

        function saveData() {
            const data = sites.map(site => ({
                id: site.id,
                url: site.url,
                initials: site.initials,
                width: document.getElementById(site.id + '-width').value,
                height: document.getElementById(site.id + '-height').value
            }));
            const json = JSON.stringify(data);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sites.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function loadData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    sites = JSON.parse(e.target.result);
                    updateIframes();
                    updateMenu();
                };
                reader.readAsText(file);
            }
        }

        function makeResizable(element) {
            const resizer = document.createElement('div');
            resizer.classList.add('resizer');
            element.appendChild(resizer);

            resizer.addEventListener('mousedown', function(e) {
                e.preventDefault();
                window.addEventListener('mousemove', resize);
                window.addEventListener('mouseup', stopResize);
            });

            function resize(e) {
                const newWidth = e.clientX - element.getBoundingClientRect().left;
                const newHeight = e.clientY - element.getBoundingClientRect().top;
                element.style.width = newWidth + 'px';
                element.style.height = newHeight + 'px';
            }

            function stopResize() {
                window.removeEventListener('mousemove', resize);
                window.removeEventListener('mouseup', stopResize);
            }
        }

        function makeDraggable(element) {
            let offsetX, offsetY;

            element.addEventListener('mousedown', function(e) {
                offsetX = e.clientX - element.getBoundingClientRect().left;
                offsetY = e.clientY - element.getBoundingClientRect().top;
                window.addEventListener('mousemove', drag);
                window.addEventListener('mouseup', stopDrag);
            });

            function drag(e) {
                element.style.left = e.clientX - offsetX + 'px';
                element.style.top = e.clientY - offsetY + 'px';
            }

            function stopDrag() {
                window.removeEventListener('mousemove', drag);
                window.removeEventListener('mouseup', stopDrag);
            }
        }

        function updateIframes() {
            const container = document.getElementById('iframe-container');
            container.innerHTML = '';
            sites.forEach(site => {
                const iframeContainer = document.createElement('div');
                iframeContainer.className = 'iframe-container';
                iframeContainer.id = site.id;

                const iframe = document.createElement('iframe');
                iframe.src = site.url;
                iframe.title = `Site ${site.initials}`;
                iframe.style.width = site.width + 'px';
                iframe.style.height = site.height + 'px';

                iframeContainer.appendChild(iframe);
                makeResizable(iframeContainer);
                makeDraggable(iframeContainer);
                container.appendChild(iframeContainer);
            });
        }

        function addSite() {
            const url = document.getElementById('new-url').value;
            const initials = document.getElementById('new-initials').value;
            const newId = `iframe${sites.length + 1}`;
            sites.push({ id: newId, url: url, initials: initials, width: 400, height: 300 });
            updateIframes();
            updateMenu();
        }

        function updateMenu() {
            const menu = document.querySelector('.anchor-buttons');
            menu.innerHTML = '<h3>Stack Tools</h3>';
            sites.forEach(site => {
                const button = document.createElement('button');
                button.textContent = site.initials;
                button.addEventListener('click', () => highlightIframe(site.id));
                menu.appendChild(button);
            });
        }

        window.onload = function() {
            updateIframes();
            updateMenu();
        };
    </script>
</head>
<body>
    <div id="iframe-container"></div>

    <div class="controls">
        <input type="file" accept=".json" onchange="loadData(event)">
        <button onclick="saveData()">Salvar Estado</button>
    </div>

    <div class="anchor-buttons">
        <h3>Stack Tools</h3>
    </div>

    <div class="input-field">
        <input type="text" id="new-url" placeholder="Nova URL">
        <input type="text" id="new-initials" placeholder="Nome da página">
        <button onclick="addSite()">Adicionar Página</button>
    </div>

    <div>
        <input type="range" min="100" max="1200" value="400" id="general-width" oninput="adjustAllSizes(this.value)">
        <span id="general-width-value">400</span> px
    </div>
</body>
</html>
